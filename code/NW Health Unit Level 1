{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d7d5e654",
   "metadata": {},
   "outputs": [],
   "source": [
    "#import necessary packages\n",
    "import platform\n",
    "import os\n",
    "import sys\n",
    "import time\n",
    "#for managing the data\n",
    "import pandas as pd\n",
    "\n",
    "#install !pip install webdriver-manager\n",
    "#webdrivers\n",
    "from selenium import webdriver\n",
    "from selenium.webdriver.chrome.service import Service as ChromeService\n",
    "from webdriver_manager.chrome import ChromeDriverManager\n",
    "from selenium.webdriver.common.by import By\n",
    "\n",
    "from bs4 import BeautifulSoup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "3df70c99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#data prefix for output data\n",
    "yearmonth = \"202404\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "d6997359",
   "metadata": {},
   "outputs": [],
   "source": [
    "#open web driver\n",
    "driver = webdriver.Chrome(service=ChromeService(ChromeDriverManager().install()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "c02b01a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#url\n",
    "base_url_list = \\\n",
    "[\n",
    "    ['Food Premisis',\"http://choosewise.nwhu.on.ca/FoodPremises/Table\", ['Name','Address','Community','Facility Type', 'Last Inspection Date', 'Inspection Result']],\n",
    "    ['Pools, Hot Tubs, Splash Pads, and Beaches',\"http://choosewise.nwhu.on.ca/PoolsHotTubsSplashPadsAndBeaches/Table\", ['Facility Type','Community','Name','Last Inspection Date','Address','Inspection Result']],\n",
    "    ['Personal Service Settings',\"http://choosewise.nwhu.on.ca/PersonalServiceSettings/Table\", ['Facility Type','Community','Last Inspection Date','Address','Name','Inspection Result']],\n",
    "    ['Small Drinking Water Systems',\"http://choosewise.nwhu.on.ca/SmallDrinkingWaterSystems/Table\",['Facility Type','Community','Name','Last Inspection Date','Address']],\n",
    "    ['Recreational Camps',\"http://choosewise.nwhu.on.ca/RecreationalCamps/Table\",['Facility Type','Community','Name','Last Inspection Date','Address']],\n",
    "    ['Camps In Unorganized Territories, Shelters And Boarding Homes',\"http://choosewise.nwhu.on.ca/CampsInUnorganizedTerritoriesSheltersAndBoardingHomes/Table\",],\n",
    "    ['Legal Actions/Orders',\"http://choosewise.nwhu.on.ca/Enforcements\",],\n",
    "]\n",
    "\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2627da7a",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "1247f93f",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_18360\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n"
     ]
    },
    {
     "ename": "IndexError",
     "evalue": "list index out of range",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mIndexError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[5], line 7\u001b[0m\n\u001b[0;32m      5\u001b[0m category \u001b[38;5;241m=\u001b[39m u[\u001b[38;5;241m0\u001b[39m]\n\u001b[0;32m      6\u001b[0m base_url \u001b[38;5;241m=\u001b[39m u[\u001b[38;5;241m1\u001b[39m]\n\u001b[1;32m----> 7\u001b[0m columns  \u001b[38;5;241m=\u001b[39m u[\u001b[38;5;241m2\u001b[39m]\n\u001b[0;32m      9\u001b[0m \u001b[38;5;66;03m#load main landing page\u001b[39;00m\n\u001b[0;32m     10\u001b[0m driver\u001b[38;5;241m.\u001b[39mget(base_url)\n",
      "\u001b[1;31mIndexError\u001b[0m: list index out of range"
     ]
    }
   ],
   "source": [
    "#place holder for final dataframe list\n",
    "df_list = []\n",
    "\n",
    "for u in base_url_list:\n",
    "    category = u[0]\n",
    "    base_url = u[1]\n",
    "    columns  = u[2]\n",
    "\n",
    "    #load main landing page\n",
    "    driver.get(base_url)\n",
    "    \n",
    "    try:\n",
    "        #find disclaimer button\n",
    "        disclamer_btn = driver.find_element(by='name', value=\"AcceptDisclaimerButton\")\n",
    "\n",
    "        #click the disclaimer button to move to the data page\n",
    "        disclamer_btn.click()\n",
    "    except:\n",
    "        pass\n",
    "    \n",
    "    # We will loop through until there's no next page button on the webpage\n",
    "    #find next page button\n",
    "    last_page = False\n",
    "\n",
    "    while last_page==False:\n",
    "        try:\n",
    "            next_btn = driver.find_element(By.CLASS_NAME, value=\"next-page-link\")\n",
    "        except:\n",
    "            last_page = True\n",
    "\n",
    "\n",
    "        #place holder for extracted data\n",
    "        data_url_list = []\n",
    "\n",
    "        #locate each table rows\n",
    "        data_rows = driver.find_elements(By.CLASS_NAME, value=\"hovereffect\")\n",
    "\n",
    "        for row in data_rows:\n",
    "            data_url_list.append( row.get_attribute(\"onclick\") )\n",
    "\n",
    "        #convert html table into dataframe\n",
    "        df = pd.read_html(driver.page_source)\n",
    "        df = df[0]\n",
    "        \n",
    "\n",
    "        #rename columns for clean up\n",
    "        df.columns = columns\n",
    "        \n",
    "        #append url column and category column\n",
    "        df['url'] = data_url_list\n",
    "        df['category'] = category\n",
    "\n",
    "        #put aside resulting table\n",
    "        df_list.append(df)\n",
    "\n",
    "        if last_page==True:\n",
    "            break\n",
    "        #move to the next page\n",
    "        next_btn.click()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "ceaeaffe",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_df = pd.concat(df_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f1bce748",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_df.to_csv( \"../data/{}_1st_table.csv\".format(yearmonth) )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "e568037c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#close webdriver\n",
    "try:\n",
    "    driver.close()\n",
    "except:\n",
    "    pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d7df1bde",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>Address</th>\n",
       "      <th>Community</th>\n",
       "      <th>Facility Type</th>\n",
       "      <th>Last Inspection Date</th>\n",
       "      <th>Inspection Result</th>\n",
       "      <th>url</th>\n",
       "      <th>category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5 Mile Corner</td>\n",
       "      <td>1284 Hwy 72 Sioux Lookout ON P8T 0A7 Canada</td>\n",
       "      <td>Sioux Lookout</td>\n",
       "      <td>Convenience / Variety</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/624b6931-da...</td>\n",
       "      <td>Food Premisis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>7 Generations Culinary Kenora Kitchen</td>\n",
       "      <td>240 Veterans Dr Kenora ON P9N 3X7 Canada</td>\n",
       "      <td>Kenora</td>\n",
       "      <td>Food Caterer</td>\n",
       "      <td>13-Dec-2023</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/1940a867-b9...</td>\n",
       "      <td>Food Premisis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7 Generations Training Kitchen</td>\n",
       "      <td>15 Fair Street Sioux Lookout Ontario P8T 1A9 C...</td>\n",
       "      <td>Sioux Lookout</td>\n",
       "      <td>Food Production</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/fd9b8750-6e...</td>\n",
       "      <td>Food Premisis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>7-Eleven Food Store</td>\n",
       "      <td>212 Government St Dryden ON P8N 2R1 Canada</td>\n",
       "      <td>Dryden</td>\n",
       "      <td>Food Take Out</td>\n",
       "      <td>15-Feb-2024</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/8fdbc6c6-8e...</td>\n",
       "      <td>Food Premisis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>807 Food Co-op</td>\n",
       "      <td>60 Princess St Dryden ON Canada</td>\n",
       "      <td>Dryden</td>\n",
       "      <td>Grocery</td>\n",
       "      <td>26-Oct-2023</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/b65dcf1b-ad...</td>\n",
       "      <td>Food Premisis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Luther Village</td>\n",
       "      <td>Dogtooth Lake Luther Village Rd Kenora ON P9N ...</td>\n",
       "      <td>Sioux Narrows</td>\n",
       "      <td>Recreational Camp</td>\n",
       "      <td>15-Jun-2023</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/98b1ef49-ff...</td>\n",
       "      <td>Recreational Camps</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Manitoba Pioneer Camp</td>\n",
       "      <td>Shoal Lake Kenora ON Canada</td>\n",
       "      <td>Fly-In/Boat-In</td>\n",
       "      <td>Recreational Camp</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/1c674c52-71...</td>\n",
       "      <td>Recreational Camps</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Rainy River Recreational Centre</td>\n",
       "      <td>302 Broadway Ave Rainy River ON P0W 1L0 Canada</td>\n",
       "      <td>Rainy River</td>\n",
       "      <td>Arena</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/ca703a1f-6a...</td>\n",
       "      <td>Recreational Camps</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Sioux Lookout Memorial Arena</td>\n",
       "      <td>85 King St Sioux Lookout ON P8T 1B9 Canada</td>\n",
       "      <td>Sioux Lookout</td>\n",
       "      <td>Arena</td>\n",
       "      <td>29-Jan-2020</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/eb6cf27e-90...</td>\n",
       "      <td>Recreational Camps</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Woodland Arena</td>\n",
       "      <td>29 Arena Lane Vermilion Bay ON P0V 2V0 Canada</td>\n",
       "      <td>Machin</td>\n",
       "      <td>Arena</td>\n",
       "      <td>30-Jan-2020</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location.href = '/Facility/Details/42826750-53...</td>\n",
       "      <td>Recreational Camps</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1336 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     Name  \\\n",
       "0                           5 Mile Corner   \n",
       "1   7 Generations Culinary Kenora Kitchen   \n",
       "2          7 Generations Training Kitchen   \n",
       "3                     7-Eleven Food Store   \n",
       "4                          807 Food Co-op   \n",
       "..                                    ...   \n",
       "16                         Luther Village   \n",
       "17                  Manitoba Pioneer Camp   \n",
       "18        Rainy River Recreational Centre   \n",
       "19           Sioux Lookout Memorial Arena   \n",
       "20                         Woodland Arena   \n",
       "\n",
       "                                              Address       Community  \\\n",
       "0         1284 Hwy 72 Sioux Lookout ON P8T 0A7 Canada   Sioux Lookout   \n",
       "1            240 Veterans Dr Kenora ON P9N 3X7 Canada          Kenora   \n",
       "2   15 Fair Street Sioux Lookout Ontario P8T 1A9 C...   Sioux Lookout   \n",
       "3          212 Government St Dryden ON P8N 2R1 Canada          Dryden   \n",
       "4                     60 Princess St Dryden ON Canada          Dryden   \n",
       "..                                                ...             ...   \n",
       "16  Dogtooth Lake Luther Village Rd Kenora ON P9N ...   Sioux Narrows   \n",
       "17                        Shoal Lake Kenora ON Canada  Fly-In/Boat-In   \n",
       "18     302 Broadway Ave Rainy River ON P0W 1L0 Canada     Rainy River   \n",
       "19         85 King St Sioux Lookout ON P8T 1B9 Canada   Sioux Lookout   \n",
       "20      29 Arena Lane Vermilion Bay ON P0V 2V0 Canada          Machin   \n",
       "\n",
       "            Facility Type Last Inspection Date  Inspection Result  \\\n",
       "0   Convenience / Variety                  NaN                NaN   \n",
       "1            Food Caterer          13-Dec-2023                NaN   \n",
       "2         Food Production                  NaN                NaN   \n",
       "3           Food Take Out          15-Feb-2024                NaN   \n",
       "4                 Grocery          26-Oct-2023                NaN   \n",
       "..                    ...                  ...                ...   \n",
       "16      Recreational Camp          15-Jun-2023                NaN   \n",
       "17      Recreational Camp                  NaN                NaN   \n",
       "18                  Arena                  NaN                NaN   \n",
       "19                  Arena          29-Jan-2020                NaN   \n",
       "20                  Arena          30-Jan-2020                NaN   \n",
       "\n",
       "                                                  url            category  \n",
       "0   location.href = '/Facility/Details/624b6931-da...       Food Premisis  \n",
       "1   location.href = '/Facility/Details/1940a867-b9...       Food Premisis  \n",
       "2   location.href = '/Facility/Details/fd9b8750-6e...       Food Premisis  \n",
       "3   location.href = '/Facility/Details/8fdbc6c6-8e...       Food Premisis  \n",
       "4   location.href = '/Facility/Details/b65dcf1b-ad...       Food Premisis  \n",
       "..                                                ...                 ...  \n",
       "16  location.href = '/Facility/Details/98b1ef49-ff...  Recreational Camps  \n",
       "17  location.href = '/Facility/Details/1c674c52-71...  Recreational Camps  \n",
       "18  location.href = '/Facility/Details/ca703a1f-6a...  Recreational Camps  \n",
       "19  location.href = '/Facility/Details/eb6cf27e-90...  Recreational Camps  \n",
       "20  location.href = '/Facility/Details/42826750-53...  Recreational Camps  \n",
       "\n",
       "[1336 rows x 8 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9280a52d",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4053b95a",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
